<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Substitute Request</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .title {
            font-size: 1.8em;
            margin-bottom: 30px;
            color: #333;
        }

        .request-info {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: left;
        }

        .request-info p {
            font-size: 1.2em;
            margin: 10px 0;
        }

        .info-label {
            font-weight: bold;
            display: inline-block;
            width: 100px;
        }

        /* Button styles */
        .btn {
            width: 50%; /* Half of the screen width */
            font-size: 1.5em; /* Increase font size */
            padding: 15px 25px; /* Adjust padding as needed */
            text-align: center; /* Ensure text is properly aligned */
            border-radius: 8px; /* Optional: rounded corners */
            margin: 0 auto;
            display: block;
        }

        /* Additional specific styles for the buttons */
        .btn-accept {
            background-color: #28a745; /* Green color */
            color: white; /* White text */
            border: none; /* Remove border */
        }

        .btn-disabled {
            background-color: #d6d6d6; /* Gray color for disabled state */
            color: black; /* Black text color */
            border: none; /* Remove border */
        }

        /* Ensure disabled buttons maintain consistent look */
        .btn:disabled {
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        {% if sub_request.status == "Open" %}
            <h1 class="title">Would you like to accept this substitute position?</h1>
        {% else %}
            <h1 class="title">Thank you but this position has been filled.</h1>
        {% endif %}

        <div class="request-info">
            <p><span class="info-label">Teacher:</span> {{ teacher.name }}</p>
            <p><span class="info-label">Date:</span> {{ sub_request.date.strftime('%B %d, %Y') }}</p>
            <p><span class="info-label">Time:</span> {{ sub_request.time }}</p>
            <p><span class="info-label">Requested:</span> {{ sub_request.created_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
            {% if sub_request.details %}
            <p><span class="info-label">Details:</span> {{ sub_request.details }}</p>
            {% endif %}
        </div>

        {% if sub_request.status == "Open" %}
            <button id="accept-btn" class="btn btn-accept" onclick="acceptRequest()">Accept This Sub Position</button>
        {% else %}
            <button class="btn btn-disabled" disabled>Position Filled</button>
        {% endif %}
    </div>

    <script>
        function acceptRequest() {
            var button = document.getElementById("accept-btn");
            button.innerText = "Processing...";
            button.disabled = true;

            fetch("{{ url_for('accept_sub_request', token=sub_request.token) }}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    button.innerText = "Position Filled";
                    button.classList.remove("btn-accept");
                    button.classList.add("btn-disabled");
                } else {
                    alert(data.message);
                    button.innerText = "Accept This Sub Position";
                    button.disabled = false;
                }
            })
            .catch(error => {
                alert("An error occurred. Please try again.");
                console.error("Error:", error);
                button.innerText = "Accept This Sub Position";
                button.disabled = false;
            });
        }
    </script>
</body>
</html>
